function dateDiff(t,e){return t&&null!=t&&""!=t&&e&&null!=e&&""!=e?Date.parse(t.toString().replace(/-/g,"/"))-Date.parse(e.toString().replace(/-/g,"/")):0}function getNowDate(){var t=new Date;return t.getFullYear()+"-"+(t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())}function diffDays(t,e){var n=this.dateDiff(e,t);return Math.floor(n/864e5)}function getStringLength(t){for(var e=0,n=0;n<t.length;n++){var i=t.charCodeAt(n);i>=1&&i<=126||65376<=i&&i<=65439?e++:e+=2}return e}function handlePostJsonError(t){404==t.status?S_toastr.error("当前请求地址未找到！"):0==t.status?S_toastr.error("网络请求超时！"):S_toastr.error("网络请求出现错误！status："+t.status+"，statusText："+t.statusText)}function handleResponse(t){var e=!1;return"401"===t.code?(S_toastr.error("当前用户状态信息已超时!点击“确定”后返回登录界面。","提示",function(){window.location.href=rootPath+"/iWork/sys/login"}),e=!0):"500"===t.code&&(S_toastr.error("出现异常错误 !详细信息："+t.msg),e=!0),e}function decimal(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var preventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},stopPropagation=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},shortTime=function(t){return moment(t).format("HH:mm")},dateSpecFormat=function(t,e){var n=moment(new Date,"YYYY-MM-DD HH:mm:ss"),i=moment(new Date,"YYYY-MM-DD HH:mm:ss").subtract(1,"days"),a=moment(moment(t).toDate(),"YYYY-MM-DD HH:mm:ss"),o=n.format("YYYY-MM-DD"),s=i.format("YYYY-MM-DD"),r=a.format("YYYY-MM-DD"),l="";return l=o==r?"今天":s==r?"昨天":r,e&&!_.isBlank(e)?_.sprintf(e,l,a.format("HH:mm")):_.sprintf("%s %s",l,a.format("HH:mm"))},dateSpecShortFormat=function(t){var e=moment(new Date,"YYYY-MM-DD HH:mm:ss"),n=moment(new Date,"YYYY-MM-DD HH:mm:ss").subtract(1,"days"),i=moment(moment(t).toDate(),"YYYY-MM-DD HH:mm:ss"),a=e.format("YYYY-MM-DD"),o=n.format("YYYY-MM-DD"),s=i.format("YYYY-MM-DD");return a==s?"今天":o==s?"昨天":s},isNullOrBlank=function(t){return void 0===t||null===t||_.isBlank(t)};!function(){for(var t,e=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],i=n.length,a=window.console=window.console||{};i--;)t=n[i],a[t]||(a[t]=e)}(),$.fn.serializeObject=function(){var t={},e=this.serializeArray();return $.each(e,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t},String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t,"gm"),e)};var cutString=function(t,e,n){if(isNullOrBlank(t))return"";for(var i=0,a="",o=0;o<t.length;o++){var s=t.charCodeAt(o);if(s>=1&&s<=126||65376<=s&&s<=65439?i++:i+=2,a+=t.charAt(o),i>=e)return a+n}return t},S_layer={dialog:function(t){var e={id:"",type:1,title:" ",anim:-1,isOutAnim:!1,time:0,area:"auto",shade:.3,shadeClose:!1,closeBtn:1,move:".layui-layer-title",moveOut:!0,maxmin:!0,moveEnd:null,fixed:!0,content:null,btn:["确定","取消"],btnAlign:"r",yes:function(t,e){layer.close(t)},cancel:function(t,e){},btn2:function(t,e){layer.close(t)},resize:!1,resizing:null,scrollbar:!1,zIndex:layer.zIndex,success:function(t){layer.setTop(t)},full:null,min:null,restore:null,end:null},n=$.extend(!0,{},e,t);layer.open(n)},panel:function(t){var e={id:"",type:1,title:!1,anim:-1,isOutAnim:!1,time:0,area:"auto",shade:.3,shadeClose:!1,closeBtn:0,move:".layui-layer-title",moveOut:!0,maxmin:!1,moveEnd:null,fixed:!0,content:null,btn:null,btnAlign:"r",cancel:function(t,e){},shown:null,resize:!1,resizing:null,scrollbar:!1,zIndex:layer.zIndex,full:null,min:null,restore:null,end:null},n=$.extend(!0,{},e,t);n.type=1,n.title=!1,n.move=".portlet-title",n.btn=null,n.maxmin=null,n.closeBtn=0,n.success=function(t){layer.setTop(t);var e=t.find('button[data-action="layer-custom-btn-yes"]');e&&e.length>0&&e.off("click.yes").on("click.yes",function(){void 0!==n.yes&&null!==n.yes&&n.yes(layer.index,t)});var i=t.find('button[data-action="layer-custom-btn-close"]');i&&i.length>0&&i.off("click.close").on("click.close",function(){layer.close(layer.index)}),void 0!==n.shown&&null!==n.shown&&n.shown(layer.index,t)},layer.open(n)}},S_swal={confirm:function(t,e){var n={title:"您确定要进行该操作吗？",text:"",type:"info",allowOutsideClick:!0,showConfirmButton:!0,showCancelButton:!0,confirmButtonClass:"btn-success",cancelButtonClass:"btn-danger",closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"确定",cancelButtonText:"取消"},i=$.extend(!0,{},n,t);swal(i,e)}},S_toastr={success:function(t){toastr.options={closeButton:!1,debug:!1,progressBar:!1,preventDuplicates:!1,positionClass:"toast-top-center",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"3000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success(t)},warning:function(t){toastr.options={closeButton:!1,debug:!1,progressBar:!1,preventDuplicates:!1,positionClass:"toast-top-center",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"3000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.warning(t)},info:function(t){toastr.options={closeButton:!1,debug:!1,progressBar:!1,preventDuplicates:!1,positionClass:"toast-top-center",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"3000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.info(t)},error:function(t){toastr.options={closeButton:!1,debug:!1,progressBar:!1,preventDuplicates:!1,positionClass:"toast-top-center",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.error(t)}},m_ajax={getJson:function(t,e,n){$.ajax({type:"GET",url:t.url,cache:!1,contentType:"application/json",beforeSend:function(){if(t.loadingEl&&App.blockUI({target:t.loadingEl,boxed:!1,animate:!0}),t.bindDisabled){var e=$(t.bindDisabled);if(e.length>0){try{e.attr("disabled",!0)}catch(t){}try{e.prop("disabled",!0)}catch(t){}}}},success:function(t){handleResponse(t)||e&&e(t)},error:function(t){n&&n(),handlePostJsonError(t)},complete:function(){t.loadingEl&&App.unblockUI(),t.bindDisabled&&setTimeout(function(){var e=$(t.bindDisabled);if(e.length>0){try{e.attr("disabled",!1)}catch(t){}try{e.prop("disabled",!1)}catch(t){}}},1e3)}})},postJson:function(t,e,n){$.ajax({type:"POST",url:t.url,cache:!1,async:null==t.async||t.async,data:JSON.stringify(t.postData),contentType:"application/json",beforeSend:function(){if(t.loadingEl&&App.blockUI({target:t.loadingEl,boxed:!1,animate:!0}),t.bindDisabled){var e=$(t.bindDisabled);if(e.length>0){try{e.attr("disabled",!0)}catch(t){}try{e.prop("disabled",!0)}catch(t){}}}},success:function(t){handleResponse(t)||e&&e(t)},error:function(t){n&&n(),handlePostJsonError(t)},complete:function(){t.loadingEl&&App.unblockUI(),t.bindDisabled&&setTimeout(function(){var e=$(t.bindDisabled);if(e.length>0){try{e.attr("disabled",!1)}catch(t){}try{e.prop("disabled",!1)}catch(t){}}},1e3)}})}},countDigits=function(t,e){var n=(t-0).toString().split("."),i=0;return n.length>1&&(i=n[1].length<e?n[1].length:e),i},doMath={accSub:function(t,e){var n,i,a,o;try{n=t.toString().split(".")[1].length}catch(t){n=0}try{i=e.toString().split(".")[1].length}catch(t){i=0}return a=Math.pow(10,Math.max(n,i)),o=n>=i?n:i,((t*a-e*a)/a).toFixed(o)},accAdd:function(t,e){var n,i,a;try{n=t.toString().split(".")[1].length}catch(t){n=0}try{i=e.toString().split(".")[1].length}catch(t){i=0}return a=Math.pow(10,Math.max(n,i)),(t*a+e*a)/a}};Number.prototype.sub=function(t){return parseFloat(doMath.accSub(this,t))},Number.prototype.add=function(t){return parseFloat(doMath.accAdd(this,t))};var restApi={url_loginSubmit:window.rootPath+"/account/login",url_getAuthenticationPage:window.rootPath+"/orgAuth/getAuthenticationPage",url_authorizeAuthentication:window.rootPath+"/orgAuth/authorizeAuthentication"};!function(){function t(t,e){return(/string|function/.test(typeof e)?r:s)(t,e)}function e(t,n){return"string"!=typeof t&&(n=typeof t,"number"===n?t+="":t="function"===n?e(t.call(t)):""),t}function n(t){return u[t]}function i(t){return e(t).replace(/&(?![\w#]+;)|[<>"']/g,n)}function a(t,e){if(p(t))for(var n=0,i=t.length;n<i;n++)e.call(t,t[n],n,t);else for(n in t)e.call(t,t[n],n)}function o(t,e){var n=/(\/)[^\/]+\1\.\.\1/,i=("./"+t).replace(/[^\/]+$/,""),a=i+e;for(a=a.replace(/\/\.\//g,"/");a.match(n);)a=a.replace(n,"/");return a}function s(e,n){var i=t.get(e)||l({filename:e,name:"Render Error",message:"Template not found"});return n?i(n):i}function r(t,e){if("string"==typeof e){var n=e;e=function(){return new d(n)}}var i=c[t]=function(n){try{return new e(n,t)+""}catch(t){return l(t)()}};return i.prototype=e.prototype=f,i.toString=function(){return e+""},i}function l(t){var e="{Template Error}",n=t.stack||"";if(n)n=n.split("\n").slice(0,2).join("\n");else for(var i in t)n+="<"+i+">\n"+t[i]+"\n\n";return function(){return"object"==typeof console&&console.error(e+"\n\n"+n),e}}var c=t.cache={},d=this.String,u={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},p=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)},f=t.utils={$helpers:{},$include:function(t,e,n){return t=o(n,t),s(t,e)},$string:e,$escape:i,$each:a},h=t.helpers=f.$helpers;t.get=function(t){return c[t.replace(/^\.\//,"")]},t.helper=function(t,e){h[t]=e},"function"==typeof define?define(function(){return t}):"undefined"!=typeof exports?module.exports=t:this.template=t,t.helper("_url",function(t){return window.rootPath+t}),t.helper("_isNullOrBlank",function(t){return void 0===t||null===t||_.isBlank(t)}),t.helper("_formatFileSize",function(t){var e;return void 0===t||null===t?"":t<1024?t+"B":t<1048576?(e=parseFloat(t/1024).toFixed(3),e.substring(0,e.length-1)+"KB"):t<1073741824?(e=parseFloat(t/1048576).toFixed(3),e.substring(0,e.length-1)+"MB"):(e=parseFloat(t/1073741824).toFixed(3),e.substring(0,e.length-1)+"GB")}),t.helper("_isNowDiffTargetDateNDaysMore",function(t,e){return moment().diff(moment(t),"days")+1>=e}),t("m_common/m_popover",function(t,e){"use strict";var n=this,i=(n.$helpers,n.$escape),a=t.popoverStyle,o=n.$string,s=t.titleHtml,r=t.contentStyle,l=t.content,c="";return c+='<div class="popover m-popover box-shadow" role="tooltip" style="',c+=i(a),c+='"> <div class="arrow" style="left: 50%;"></div>  ',c+=o(s),c+=' <div class="popover-content" style="',c+=i(r),c+='"> ',c+=o(l),c+=" </div> </div>",new d(c)}),t("m_common/m_popover_confirm",function(t,e){"use strict";var n=this,i=(n.$helpers,n.$string),a=t.confirmMsg,o="";return o+='<div> <p class="f-s-13">',o+=i(a),o+='</p> <p class="pull-right" > <button type="button" class="popover-btn-no btn btn-default btn-xs m-popover-close" style="line-height:22px;">取消 </button> <button type="button" class="popover-btn-yes btn btn-success btn-xs m-popover-submit" style="line-height:22px;">确定</button> </p> </div>',new d(o)}),t("m_common/m_sidebar",function(t,e){"use strict";var n=this,i=n.$helpers,a=n.$escape,o=i._url,s="";return s+='  <div class="page-sidebar navbar-collapse collapse">        <ul class="page-sidebar-menu" data-keep-expanded="false" data-auto-scroll="true" data-slide-speed="200">  <li class="heading"> <h3 class="uppercase">企业认证</h3> </li> <li class="nav-item"> <a href="',s+=a(o("/orgAuth/approveList")),s+='" class="nav-link" data-nav-id="orgAuth-approveList"> <i class="icon-briefcase"></i> <span class="title">认证审核</span> <span class="selected"></span> </a> </li>  </ul> </div>',new d(s)}),t("m_orgAuth/m_orgAuth_list",'<div class="page-content" style="padding-top: 0;">  <div class="row"> <div class="col-md-12"> <div class="portlet light" style="overflow: hidden;"> <div class="portlet-title"> <div class="caption">  <span class="caption-subject bold font-yellow-casablanca uppercase">企业认证审核</span> </div> <div class="actions"> <a class="btn btn-circle btn-icon-only btn-default fullscreen" href="javascript:void(0);"> </a> </div> <div class="inputs" style="margin-right: 10px;"> <div class="portlet-input input-inline input-medium"> <div class="input-group"> <input type="text" class="form-control input-circle-left search-input" placeholder="请输入关键字"> <span class="input-group-btn"> <button class="btn btn-circle-right btn-default" data-action="search">搜索</button> </span> </div> </div> </div> </div> <div class="portlet-body"> <table class="table table-striped table-bordered table-hover" id="list"> <thead> <tr> <th>序号</th> <th>组织名称</th> <th>企业名称</th> <th>证件类型</th> <th>注册号/统一社会代码</th> <th>法人</th> <th>经办人</th> <th name="field_applyDate">认证时间</th> <th class="text-center">审核状态</th> <th>审核人</th> <th name="field_auditDate">审核时间</th> </tr> </thead> <tbody class="m-page-data"> </tbody> </table> </div> <div class="clearfix"></div> <div id="orgAuthList_sortSwap"></div> <div class="m-page pull-right" style="margin-bottom: 20px;"></div> </div> </div> </div> </div>'),t("m_orgAuth/m_orgAuth_list_row",function(t,e){"use strict";var n=this,i=n.$helpers,a=n.$each,o=t.list,s=(t.o,t.i,n.$escape),r=t.pageIndex,l=t.pageSize,c=i._isNullOrBlank,u=i._isNowDiffTargetDateNDaysMore,p="";return a(o,function(t,e){p+=' <tr class="odd gradeX"> <td>',p+=s(r*l+e+1),p+="</td> <td>",p+=s(t.orgAlias),p+="</td> <td>",p+=s(t.orgName),p+="</td> <td> ",0===t.businessLicenseType?p+=" 普通营业执照 ":1===t.businessLicenseType&&(p+=" 多证合一营业执照 "),p+=" ",c(t.legalRepresentativePhoto)||(p+=' <a href="javascript:void(0);" data-action="preview" data-url="',p+=s(t.legalRepresentativePhoto),p+='"><i class="fa fa-file-image-o"></i></a> '),p+=" </td> <td>",p+=s(t.businessLicenseNumber),p+="</td> <td> ",p+=s(t.legalRepresentative),p+=" ",c(t.businessLicensePhoto)||(p+=' <a href="javascript:void(0);" data-action="preview" data-url="',p+=s(t.businessLicensePhoto),p+='"><i class="fa fa-file-image-o"></i></a> '),p+=" </td> <td> ",p+=s(t.operatorName),p+=" ",c(t.operatorPhoto)||(p+=' <a href="javascript:void(0);" data-action="preview" data-url="',p+=s(t.operatorPhoto),p+='"><i class="fa fa-file-image-o"></i></a> '),p+=" </td> <td> ",1===t.authenticationStatus&&u(t.applyDate,3)?(p+=' <span style="color: red;">',p+=s(t.applyDate),p+="</span> "):(p+=" ",p+=s(t.applyDate),p+=" "),p+=" ",c(t.sealPhoto)||(p+=' <a href="javascript:void(0);" data-action="preview" data-url="',p+=s(t.sealPhoto),p+='"><i class="fa fa-file-image-o"></i></a> '),p+=' </td> <td style="width: 90px;max-width: 90px;padding-left:15px;padding-right: 15px;"> ',0===t.authenticationStatus?p+=' <span class="label label-sm label-warning span-tag-60-25" style="width: 60px;">未提交</span> ':1===t.authenticationStatus?(p+=' <div class="btn-toolbar"> <div class="btn-group"> <button class="btn btn-xs btn-info dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" style="width: 60px;"> 审核 </button> <ul class="dropdown-menu dropdown-menu-left dropdown-menu-v1" role="menu"> <li> <a href="javascript:void(0);" data-action="audit_pass" data-id="',p+=s(t.id),p+='">通过</a> </li> <li> <a href="javascript:void(0);" data-action="audit_reject" data-id="',p+=s(t.id),p+='">不通过</a> </li> </ul> </div> </div> '):2===t.authenticationStatus?(p+='  <div class="btn-toolbar"> <div class="btn-group"> <button class="btn btn-xs btn-success dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" style="width: 60px;"> 已通过 </button> <ul class="dropdown-menu dropdown-menu-left dropdown-menu-v1" role="menu"> <li> <a href="javascript:void(0);" data-action="audit_reject" data-id="',p+=s(t.id),p+='">重置为不通过</a> </li> </ul> </div> </div> '):3===t.authenticationStatus&&(p+='  <div class="btn-toolbar"> <div class="btn-group"> <button class="btn btn-xs btn-danger dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" style="width: 60px;"> 不通过 </button> <ul class="dropdown-menu dropdown-menu-left dropdown-menu-v1" role="menu"> <li> <a href="javascript:void(0);" data-action="audit_view" data-id="',p+=s(t.id),p+='" data-reject-type="',p+=s(t.rejectType),p+='" data-reject-reason="',p+=s(t.rejectReason),p+='" data-auditor-name="',p+=s(t.auditorName),p+='">查看原因</a> </li> <li> <a href="javascript:void(0);" data-action="audit_pass" data-id="',p+=s(t.id),p+='">重置为通过</a> </li> </ul> </div> </div> '),p+=" </td> <td>",p+=s(t.auditorName),p+="</td> <td>",p+=s(t.auditDate),p+="</td> </tr> "}),new d(p)}),t("m_orgAuth/m_orgAuth_reject",'<div class="portlet light" style="overflow: hidden;"> <div class="portlet-title"> <div class="caption">  <span class="caption-subject bold font-yellow-casablanca uppercase">不通过原因</span> </div> <div class="tools"> <a href="" class="remove" data-original-title="" title=""> </a> </div> </div> <div class="portlet-body"> <form class="form-horizontal" role="form"> <div class="form-body"> <div class="form-group"> <label class="col-md-2 control-label">原因：</label> <div class="col-md-9"> <select id="rejectType"></select> </div> </div> <div class="form-group"> <label class="col-md-2 control-label">说明：</label> <div class="col-md-9"> <textarea id="rejectReason" class="form-control" rows="5"></textarea> </div> </div> </div> </form> </div> <div class="modal-footer"> <button type="button" class="btn btn-success" data-action="layer-custom-btn-yes">确&nbsp;定</button> <button type="button" class="btn btn-default" data-action="layer-custom-btn-close">取&nbsp;消</button> </div> </div>'),t("m_orgAuth/m_orgAuth_view",'<div class="portlet light" style="overflow: hidden;"> <div class="portlet-title"> <div class="caption">  <span class="caption-subject bold font-yellow-casablanca uppercase">不通过原因</span> </div> <div class="tools"> <a href="" class="remove" data-original-title="" title=""> </a> </div> </div> <div class="portlet-body"> <form class="form-horizontal" role="form"> <div class="form-body"> <div class="form-group"> <label class="col-md-2 control-label">原因：</label> <div class="col-md-9"> <select id="rejectType"></select> </div> </div> <div class="form-group"> <label class="col-md-2 control-label">说明：</label> <div class="col-md-9"> <textarea id="rejectReason" class="form-control" rows="5"></textarea> </div> </div> </div> </form> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-action="layer-custom-btn-close">关&nbsp;闭</button> </div> </div>')}(),function(t,e,n,i){"use strict";function a(t,e){this.element=t,this.settings=e,this._defaults=s,this._name=o,this._popoverTop=null,this._popoverHeight=null,this.init()}var o="m_popover",s={clearOnInit:!0,titleHtml:null,hideArrow:!1,popoverStyle:"",contentStyle:"padding: 10px 14px 10px;",content:null,placement:null,onShown:null,onSave:null,onClear:null,onClose:null,template:"m_common/m_popover",closeOnDocumentClicked:null};t.extend(a.prototype,{init:function(){var e=this;!0===e.settings.clearOnInit&&(t(n).find(".m-popover").each(function(e,n){t(n).remove()}),t(n).off("click.m-popover"));var i=template(e.settings.template,{titleHtml:e.settings.titleHtml,popoverStyle:e.settings.popoverStyle,contentStyle:e.settings.contentStyle,content:e.settings.content});t(i).insertAfter(t(e.element));var a=t(e.element).next(".m-popover");!0===e.settings.hideArrow&&a.find(".arrow").eq(0).hide(),e.settings.onShown&&null!==e.settings.onShown&&e.settings.onShown(a),a.off("click.m-popover").on("click.m-popover",function(t){return stopPropagation(t),!1}),setTimeout(function(){e.setPosition(),e.bindBtnClick(),e.bindPopoverClickedOut()},50),a.find('input[type="text"]').keydown(function(){if("13"==event.keyCode){var t=a.find(".m-popover-submit");t&&t.length>0&&t.click()}})},bindPopoverClickedOut:function(){var e=this;t(n).on("click.m-popover",function(n){var i=t(n.target).parents(".select2-container").length>0||t(n.target).is(".select2-container");return!(t(n.target).closest(".select2-search__field").length>0||i)&&(("function"!=typeof e.settings.closeOnDocumentClicked||!1!==e.settings.closeOnDocumentClicked(n))&&void(e.settings.onClose&&null!==e.settings.onClose?!1!==e.settings.onClose(t(n.target))&&e.closeFilter():e.closeFilter()))})},setPosition:function(){var e=this,n=t(e.element).next(".m-popover");if(n.length>0){var i=e.settings.placement?e.settings.placement:"top",a=t(e.element).position().top,o=t(e.element).outerWidth(),s=t(e.element).outerHeight(),r=t(e.element).position().left,l=n.width(),c=n.outerHeight(),d=0,u=0;switch(i){case"top":d=a-c,u=r+o/2-l/2;break;case"bottom":d=a+s,u=r+o/2-l/2;break;case"left":d=a-c/2+5,u=r-l-10;break;case"right":d=a-c/2+7,u=r+o}e._popoverTop=d,e._popoverHeight=c,n.removeClass("top").addClass(i),(i.indexOf("left")>-1||i.indexOf("right")>-1)&&n.find(".arrow").css({top:"50%",left:""}),n.css({display:"inline-block",position:"absolute",top:d,left:u})}},bindBtnClick:function(){var e=this,n=t(e.element).next(".m-popover");if(n.length>0){var i=n.find(".m-popover-submit");i.length>0&&i.click(function(t){return e.settings.onSave&&null!==e.settings.onSave?!1!==e.settings.onSave(n)&&e.closeFilter():e.closeFilter(),stopPropagation(t),!1});var a=n.find(".m-popover-clear");a.length>0&&a.click(function(i){if(e.settings.onClear&&null!==e.settings.onClear)e.settings.onClear(n);else{var a=t(this).closest("form").find("input:first");a.length>0&&a.val("")}return stopPropagation(i),!1});var o=n.find(".m-popover-close");o.length>0&&o.click(function(t){return e.settings.onClose&&null!==e.settings.onClose?!1!==e.settings.onClose(n)&&e.closeFilter():e.closeFilter(),stopPropagation(t),!1}),n.resize(function(){setTimeout(function(){e.changePosition(n)},20)})}},changePosition:function(t){var e=this,n=t.find("label.error").length,i=(t.find("label.error").outerHeight(),t.height()),a=(t.position().top,i-e._popoverHeight);if(null!=e.settings.placement&&"top"==e.settings.placement)if(-4==a)t.css("top",e._popoverTop+"px");else{var o=e._popoverTop-a-4;t.css("top",o)}else null==e.settings.placement||"left"!=e.settings.placement&&"right"!=e.settings.placement||t.find(".arrow").css("top",e._popoverHeight/2+"px")},closeFilter:function(){t(this.element).siblings(".m-popover").each(function(e,n){t(n).remove()}),t(n).off("click.m-popover")}}),t.fn[o]=function(e,n){var i,r,l=this.each(function(){if(i=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?i=new a(this,l):void 0!==i&&null!==i||(i=new a(this,l)),t.data(this,"plugin_"+o,i)}else"string"==typeof e&&"function"==typeof i[e]&&(r=i[e].call(i,n))});return void 0===r?l:r}}(jQuery,window,document),function(t,e,n,i){"use strict";function a(t,e){this.element=t,this.settings=e,this._defaults=s,this._name=o,this.init()}var o="m_sidebar",s={};t.extend(a.prototype,{init:function(){this._render()},_render:function(){var e=this,n=template("m_common/m_sidebar",{});t(e.element).html(n),e._bindAction()},_bindAction:function(){var e=this,n=t(e.element).attr("data-nav-id");t(e.element).find("a.nav-link").each(function(e,i){var a=t(i);a.attr("data-nav-id")===n&&a.closest(".nav-item").addClass("active open")})}}),t.fn[o]=function(e,n){var i,r,l=this.each(function(){if(i=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?i=new a(this,l):void 0!==i&&null!==i||(i=new a(this,l)),t.data(this,"plugin_"+o,i)}else"string"==typeof e&&"function"==typeof i[e]&&(r=i[e].call(i,n))});return void 0===r?l:r}}(jQuery,window,document),function(t,e,n,i){"use strict";function a(t,e){this.element=t,this.settings=e,this._defaults=s,this._name=o,this._rejectReasons=[{id:1,text:"企业认证名称与营业执照不符"},{id:2,text:"营业执照复印件无盖红章"},{id:3,text:"营业执照复印件无签署文字“仅用于卯丁认证使用"},{id:4,text:"营业执照过期"},{id:5,text:"营业执照图片模糊"},{id:6,text:"法人身份证与营业执照不符合"},{id:7,text:"法人身份证图片模糊"},{id:8,text:"法人身份证已过期"},{id:8,text:"经办人身份证图片模糊"},{id:9,text:"经办人身份证已过期"},{id:10,text:"证照无法查验"}],this.init()}var o="m_orgAuth",s={};t.extend(a.prototype,{init:function(){this._render()},_render:function(){var e=this,n=template("m_orgAuth/m_orgAuth_list",{});t(e.element).html(n),e._bindPage(),e._bindSearch(),e._bindSortFields()},_bindPage:function(){var e=this,n=t(e.element).find(".m-page:first"),i=e._remote();n.m_page({loadingEl:t(e.element).find(".portlet"),pageSize:20,remote:i},!0)},_remote:function(){var e=this,n=t(e.element).find(".m-page:first"),i=function(n){var i={pageIndex:n.pageIndex,pageSize:n.pageSize},a=t(e.element).find(".search-input").val();isNullOrBlank(a)||t.extend(!0,i,{orgNameMask:a,orgAliasMask:a});var o=t("#orgAuthList_sortSwap").attr("data-sortField");if(!isNullOrBlank(o))if("applyDate"===o){var s=t("#orgAuthList_sortSwap").attr("data-sortType");"asc"===s?t.extend(!0,i,{orderCondition:{applyDate:1}}):"desc"===s&&t.extend(!0,i,{orderCondition:{applyDate:-1}})}else if("auditDate"===o){var s=t("#orgAuthList_sortSwap").attr("data-sortType");"asc"===s?t.extend(!0,i,{orderCondition:{auditDate:1}}):"desc"===s&&t.extend(!0,i,{orderCondition:{auditDate:-1}})}return i};return{url:restApi.url_getAuthenticationPage,pageParams:i,success:function(i){if("0"==i.code){var a={};a.pageIndex=n.pagination("getPageIndex"),a.pageSize=n.pagination("getPageSize"),a.list=i.data.list;var o=template("m_orgAuth/m_orgAuth_list_row",a);t(e.element).find(".m-page-data").html(o),e._bindAudit(),e._bindAttachPreview()}else S_toastr.error(i.msg)}}},_refreshList:function(e){var n=this,i=t(n.element).find(".m-page:first"),a=i.pagination("getPageIndex");!0===e&&(a=0),i.pagination("setPageIndex",a).pagination("setParams",{}).pagination("remote")},_bindSearch:function(){var e=this;t(e.element).find('button[data-action="search"]').click(function(){e._refreshList(!0)})},_bindSortFields:function(){var e=this,n=function(t,n){e._refreshList(!0)};t('th[name="field_applyDate"]').m_sortableField({swapId:"#orgAuthList_sortSwap",field:"applyDate",onChanged:n},!0),t('th[name="field_auditDate"]').m_sortableField({swapId:"#orgAuthList_sortSwap",field:"auditDate",onChanged:n},!0)},_bindAudit:function(){var n=this;t(n.element).find('a[data-action="audit_pass"]').click(function(){var i=t(this);S_swal.confirm({title:"您确定要批准通过该认证吗？"},function(t){if(t){var a={url:restApi.url_authorizeAuthentication,postData:{id:i.attr("data-id"),authenticationStatus:2,auditorName:e.currentAccountName}};m_ajax.postJson(a,function(t){"0"===t.code?(S_toastr.success("提交成功"),n._refreshList()):S_toastr.error(t.msg)})}})}),t(n.element).find('a[data-action="audit_reject"]').click(function(){var i=t(this);S_layer.panel({area:["700px","340px"],content:template("m_orgAuth/m_orgAuth_reject",{}),zIndex:100,shown:function(e,i){t("#rejectType").m_select2_localData({width:"495px",data:n._rejectReasons},!0)},yes:function(t,a){var o={url:restApi.url_authorizeAuthentication,loadingEl:a.find(".portlet"),postData:{id:i.attr("data-id"),authenticationStatus:3,auditorName:e.currentAccountName,rejectType:a.find("#rejectType").val(),rejectReason:a.find("#rejectReason").val()}};m_ajax.postJson(o,function(e){"0"===e.code?(S_toastr.success("提交成功"),n._refreshList(),layer.close(t)):S_toastr.error(e.msg)})}})}),t(n.element).find('a[data-action="audit_view"]').click(function(){var e=t(this);S_layer.panel({area:["700px","340px"],content:template("m_orgAuth/m_orgAuth_view",{}),zIndex:100,shown:function(i,a){t("#rejectType").m_select2_localData({width:"495px",data:n._rejectReasons},!0),t("#rejectType").val(e.attr("data-reject-type")).trigger("change").prop("disabled",!0),a.find("#rejectReason").val(e.attr("data-reject-reason")).prop("readonly",!0)}})})},_bindAttachPreview:function(){var e=this;t.each(t(e.element).find('a[data-action="preview"]'),function(e,n){t(n).off("click.preview").on("click.preview",function(){var e=t(this),n=[];n.push({alt:null,pid:null,src:e.attr("data-url")});var i=e.closest("tr");console.log(i),t.each(i.find('a[data-action="preview"]'),function(i,a){var o=t(a);o.attr("data-url")!==e.attr("data-url")&&n.push({alt:null,pid:null,src:o.attr("data-url")})});var a={title:"企业认证附件",id:1,start:0,data:n};layer.photos({photos:a,shift:5})})})}}),t.fn[o]=function(e,n){var i,r,l=this.each(function(){if(i=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?i=new a(this,l):void 0!==i&&null!==i||(i=new a(this,l)),t.data(this,"plugin_"+o,i)}else"string"==typeof e&&"function"==typeof i[e]&&(r=i[e].call(i,n))});return void 0===r?l:r}}(jQuery,window,document),function(t,e,n,i){"use strict";function a(e,n){this.element=e;var i=t.extend({},s.remote,n.remote);this.settings=n,this.settings.remote=i,this._defaults=s,this._name=o,this.init()}var o="m_page",s={loadingEl:null,pageIndex:0,pageSize:10,total:0,pageBtnCount:5,showFirstLastBtn:!1,firstBtnText:null,lastBtnText:null,prevBtnText:"上一页",nextBtnText:"下一页",loadFirstPage:!0,remote:{url:null,params:null,pageParams:null,success:null,beforeSend:null,complete:null,pageIndexName:"pageIndex",pageSizeName:"pageSize",totalName:"data.total",traditional:!1,remoteWrongFormat:null},pageElementSort:["$page","$size","$jump","$info"],showInfo:!1,infoFormat:"{start} ~ {end} of {total} entires",noInfoText:"0 entires",showJump:!1,jumpBtnText:"Go",showPageSizes:!1,pageSizeItems:[5,10,15,20],debug:!1};t.extend(a.prototype,{init:function(){var e=this;null!==e.settings.loadingEl&&null===e.settings.remote.beforeSend&&(e.settings.remote.beforeSend=function(){App.blockUI({target:e.settings.loadingEl,boxed:!1,animate:!0})}),null!==e.settings.loadingEl&&null===e.settings.remote.complete&&(e.settings.remote.complete=function(){App.unblockUI(e.settings.loadingEl)}),null===e.settings.remote.remoteWrongFormat&&(e.settings.remote.remoteWrongFormat=function(t){t&&"500"===t.code&&S_toastr.error("很抱歉，请求发生异常")}),t(e.element).pagination()&&t(e.element).pagination("destroy"),t(e.element).pagination(e.settings)}}),t.fn[o]=function(e,n){var i,r,l=this.each(function(){if(i=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?i=new a(this,l):void 0!==i&&null!==i||(i=new a(this,l)),t.data(this,"plugin_"+o,i)}else"string"==typeof e&&"function"==typeof i[e]&&(r=i[e].call(i,n))});return void 0===r?l:r}}(jQuery,window,document),function(t,e,n,i){"use strict";function a(t,e){this.element=t,this.settings=e,this._defaults=s,this._name=o,this.init()}var o="m_select2_localData",s={allowClear:!1,language:"zh-CN",minimumResultsForSearch:1/0,data:[]};t.extend(a.prototype,{init:function(){var e=this;t(e.element).select2(e.settings)}}),t.fn[o]=function(e,n){var i,r,l=this.each(function(){if(i=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?i=new a(this,l):void 0!==i&&null!==i||(i=new a(this,l)),t.data(this,"plugin_"+o,i)}else"string"==typeof e&&"function"==typeof i[e]&&(r=i[e].call(i,n))});return void 0===r?l:r}}(jQuery,window,document),function(t,e,n,i){"use strict";function a(e,n){this.element=e,this.settings=n,this._defaults=s,this._name=o,this.settings.field=this.settings.field||t(this.element).attr("name"),this.init()}var o="m_sortableField",s={swapId:null,field:null,sortType:"",onChanged:null};t.extend(a.prototype,{init:function(){var t=this;t._render(),t._bindClick()},_render:function(){var e=this,n=t(e.element);if(n.addClass("field-sortable"),n.append('<span class="field-sort-indicator"></span>'),e.settings.swapId&&null!==e.settings.swapId){var i=t(e.settings.swapId);if(i.length>0&&i.attr("data-sortField")===e.settings.field){var a=i.attr("data-sortType");e.settings.sortType=a,"asc"===a?n.addClass("field-sorted-asc"):"desc"===a&&n.addClass("field-sorted-desc"),n.closest("th").siblings().each(function(e,n){var i=t(n);i.removeClass("field-sorted-asc"),i.removeClass("field-sorted-desc")})}}},_bindClick:function(){var e=this,n=t(e.element);n.find(".field-sort-indicator").click(function(){switch(n.removeClass("field-sorted-asc"),n.removeClass("field-sorted-desc"),n.closest("th").siblings().each(function(e,n){var i=t(n);i.removeClass("field-sorted-asc"),i.removeClass("field-sorted-desc")}),e.settings.sortType){case"":e.settings.sortType="asc",t(e.element).addClass("field-sorted-asc");break;case"asc":
e.settings.sortType="desc",t(e.element).addClass("field-sorted-desc");break;case"desc":e.settings.sortType=""}if(e.settings.swapId&&null!==e.settings.swapId){var i=t(e.settings.swapId);i.length>0&&(isNullOrBlank(e.settings.sortType)?(i.removeAttr("data-sortField"),i.removeAttr("data-sortType")):(i.attr("data-sortField",e.settings.field),i.attr("data-sortType",e.settings.sortType)))}e.settings.onChanged&&null!==e.settings.onChanged&&e.settings.onChanged(e.settings.field,e.settings.sortType)})}}),t.fn[o]=function(e,n){var i,r,l=this.each(function(){if(i=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?i=new a(this,l):void 0!==i&&null!==i||(i=new a(this,l)),t.data(this,"plugin_"+o,i)}else"string"==typeof e&&"function"==typeof i[e]&&(r=i[e].call(i,n))});return void 0===r?l:r}}(jQuery,window,document);var login={init:function(){var t=this;t._bindAction(),t._bindKeyDownEnter(),$.backstretch([window.rootPath+"/assets/img/bg/1.jpg",window.rootPath+"/assets/img/bg/2.jpg",window.rootPath+"/assets/img/bg/3.jpg"],{fade:1e3,duration:5e3})},_bindAction:function(){var t=this;$("#btnLogin").click(function(){t._login()})},_bindKeyDownEnter:function(){var t=this;$("#account").keydown(function(e){if(13==event.keyCode)return t._login(),stopPropagation(e),preventDefault(e),!1}),$("#password").keydown(function(e){if(13==event.keyCode)return t._login(),stopPropagation(e),preventDefault(e),!1})},_login:function(){var t=$("#account").val(),e=$("#password").val();if(isNullOrBlank(t)||isNullOrBlank(e))return void S_toastr.warning("账号或密码不能为空");var n={url:restApi.url_loginSubmit,loadingEl:"",postData:{account:t,password:e}};m_ajax.postJson(n,function(t){"0"===t.code?(S_toastr.success("登陆成功，正在跳转..."),setTimeout(function(){window.location.href=window.rootPath+"/orgAuth/approveList"},1e3)):S_toastr.error(t.msg)})}},orgAuth_approveList={init:function(){$(".page-content-wrapper").m_orgAuth({},!0)}},main={init:function(t){var e=this;e._initSelect2(),e._initSidebar(),e._initPageJs(t)},_initSidebar:function(){var t=$(".page-sidebar-wrapper");t.length>0&&t.m_sidebar()},_initPageJs:function(t){t&&t.init&&t.init()},_initSelect2:function(){$.fn.select2&&$.fn.select2.defaults.set("theme","bootstrap")}};