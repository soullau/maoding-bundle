function dateDiff(t,e){return t&&null!=t&&""!=t&&e&&null!=e&&""!=e?Date.parse(t.toString().replace(/-/g,"/"))-Date.parse(e.toString().replace(/-/g,"/")):0}function getNowDate(){var t=new Date;return t.getFullYear()+"-"+(t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())}function diffDays(t,e){var n=this.dateDiff(e,t);return Math.floor(n/864e5)}function getStringLength(t){for(var e=0,n=0;n<t.length;n++){var a=t.charCodeAt(n);a>=1&&a<=126||65376<=a&&a<=65439?e++:e+=2}return e}function decimal(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var preventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},stopPropagation=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},shortTime=function(t){return moment(t).format("HH:mm")},dateSpecFormat=function(t,e){var n=moment(new Date,"YYYY-MM-DD HH:mm:ss"),a=moment(new Date,"YYYY-MM-DD HH:mm:ss").subtract(1,"days"),i=moment(moment(t).toDate(),"YYYY-MM-DD HH:mm:ss"),o=n.format("YYYY-MM-DD"),s=a.format("YYYY-MM-DD"),r=i.format("YYYY-MM-DD"),l="";return l=o==r?"今天":s==r?"昨天":r,e&&!_.isBlank(e)?_.sprintf(e,l,i.format("HH:mm")):_.sprintf("%s %s",l,i.format("HH:mm"))},dateSpecShortFormat=function(t){var e=moment(new Date,"YYYY-MM-DD HH:mm:ss"),n=moment(new Date,"YYYY-MM-DD HH:mm:ss").subtract(1,"days"),a=moment(moment(t).toDate(),"YYYY-MM-DD HH:mm:ss"),i=e.format("YYYY-MM-DD"),o=n.format("YYYY-MM-DD"),s=a.format("YYYY-MM-DD");return i==s?"今天":o==s?"昨天":s},isNullOrBlank=function(t){return void 0===t||null===t||_.isBlank(t)};!function(){for(var t,e=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],a=n.length,i=window.console=window.console||{};a--;)t=n[a],i[t]||(i[t]=e)}(),$.fn.serializeObject=function(){var t={},e=this.serializeArray();return $.each(e,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t},String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t,"gm"),e)};var cutString=function(t,e,n){if(isNullOrBlank(t))return"";for(var a=0,i="",o=0;o<t.length;o++){var s=t.charCodeAt(o);if(s>=1&&s<=126||65376<=s&&s<=65439?a++:a+=2,i+=t.charAt(o),a>=e)return i+n}return t},S_layer={dialog:function(t){var e={id:"",type:1,title:" ",anim:-1,isOutAnim:!1,time:0,area:"auto",shade:.3,shadeClose:!1,closeBtn:1,move:".layui-layer-title",moveOut:!0,maxmin:!0,moveEnd:null,fixed:!0,content:null,btn:["确定","取消"],btnAlign:"r",yes:function(t,e){layer.close(t)},cancel:function(t,e){},btn2:function(t,e){layer.close(t)},resize:!1,resizing:null,scrollbar:!1,zIndex:layer.zIndex,success:function(t){layer.setTop(t)},full:null,min:null,restore:null,end:null},n=$.extend(!0,{},e,t);layer.open(n)},panel:function(t){var e={id:"",type:1,title:!1,anim:-1,isOutAnim:!1,time:0,area:"auto",shade:.3,shadeClose:!1,closeBtn:0,move:".layui-layer-title",moveOut:!0,maxmin:!1,moveEnd:null,fixed:!0,content:null,btn:null,btnAlign:"r",cancel:function(t,e){},shown:null,resize:!1,resizing:null,scrollbar:!1,zIndex:layer.zIndex,full:null,min:null,restore:null,end:null},n=$.extend(!0,{},e,t);n.type=1,n.title=!1,n.move=".portlet-title",n.btn=null,n.maxmin=null,n.closeBtn=0,n.success=function(t){layer.setTop(t);var e=t.find('button[data-action="layer-custom-btn-yes"]');e&&e.length>0&&e.off("click.yes").on("click.yes",function(){void 0!==n.yes&&null!==n.yes&&n.yes(layer.index,t)});var a=t.find('button[data-action="layer-custom-btn-close"]');a&&a.length>0&&a.off("click.close").on("click.close",function(){layer.close(layer.index)}),void 0!==n.shown&&null!==n.shown&&n.shown(layer.index,t)},layer.open(n)}},S_swal={confirm:function(t,e){var n={title:"您确定要进行该操作吗？",text:"",type:"info",allowOutsideClick:!0,showConfirmButton:!0,showCancelButton:!0,confirmButtonClass:"btn-success",cancelButtonClass:"btn-danger",closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"确定",cancelButtonText:"取消"},a=$.extend(!0,{},n,t);swal(a,e)}},S_toastr={success:function(t){toastr.options={closeButton:!1,debug:!1,progressBar:!1,preventDuplicates:!1,positionClass:"toast-top-center",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"3000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success(t)},warning:function(t){toastr.options={closeButton:!1,debug:!1,progressBar:!1,preventDuplicates:!1,positionClass:"toast-top-center",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"3000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.warning(t)},info:function(t){toastr.options={closeButton:!1,debug:!1,progressBar:!1,preventDuplicates:!1,positionClass:"toast-top-center",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"3000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.info(t)},error:function(t){toastr.options={closeButton:!1,debug:!1,progressBar:!1,preventDuplicates:!1,positionClass:"toast-top-center",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.error(t)},clear:function(){toastr.clear()}},S_loading={_blockUI:function(t){t=$.extend(!0,{},t);var e="";if(e=t.animate?'<div class="loading-message '+(t.boxed?"loading-message-boxed":"")+'"><div class="block-spinner-bar"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div>':t.iconOnly?'<div class="loading-message '+(t.boxed?"loading-message-boxed":"")+'"><img src="'+this.getGlobalImgPath()+'loading-spinner-grey.gif" align=""></div>':t.textOnly?'<div class="loading-message '+(t.boxed?"loading-message-boxed":"")+'"><span>&nbsp;&nbsp;'+(t.message?t.message:"LOADING...")+"</span></div>":'<div class="loading-message '+(t.boxed?"loading-message-boxed":"")+'"><img src="'+this.getGlobalImgPath()+'loading-spinner-grey.gif" align=""><span>&nbsp;&nbsp;'+(t.message?t.message:"LOADING...")+"</span></div>",t.target){var n=$(t.target);n.height()<=$(window).height()&&(t.cenrerY=!0),n.block({message:e,baseZ:t.zIndex?t.zIndex:1e3,centerY:void 0!==t.cenrerY&&t.cenrerY,css:{top:"10%",border:"0",padding:"0",backgroundColor:"none"},overlayCSS:{backgroundColor:t.overlayColor?t.overlayColor:"#555",opacity:t.boxed?.05:.1,cursor:"wait"}})}else $.blockUI({message:e,baseZ:t.zIndex?t.zIndex:1e3,css:{border:"0",padding:"0",backgroundColor:"none"},overlayCSS:{backgroundColor:t.overlayColor?t.overlayColor:"#555",opacity:t.boxed?.05:.1,cursor:"wait"}})},show:function(t,e){var n=this;isNullOrBlank(e)?n._blockUI({target:t,boxed:!1,animate:!1,textOnly:!0,iconOnly:!1,message:e,zIndex:null,overlayColor:null}):n._blockUI({target:t,boxed:!1,animate:!0,textOnly:!1,iconOnly:!1,message:null,zIndex:null,overlayColor:null})},hide:function(t){t?$(t).unblock({onUnblock:function(){$(t).css("position",""),$(t).css("zoom","")}}):$.unblockUI()}},handlePostJsonError=function(t){404==t.status?S_toastr.error("当前请求地址未找到！"):0==t.status?S_toastr.error("网络请求超时！"):S_toastr.error("网络请求出现错误！status："+t.status+"，statusText："+t.statusText)},handleResponse=function(t){var e=!1;return"401"===t.code?(S_toastr.error("用户登录已超时"),e=!0):"500"===t.code&&(S_toastr.error("出现异常错误 !详细信息："+t.msg),e=!0),e},m_ajax={getJson:function(t,e,n){$.ajax({type:"GET",url:t.url,cache:!1,contentType:"application/json",beforeSend:function(){if(t.loadingEl&&S_loading.show(t.loadingEl),t.bindDisabled){var e=$(t.bindDisabled);if(e.length>0){try{e.attr("disabled",!0)}catch(t){}try{e.prop("disabled",!0)}catch(t){}}}},success:function(t){handleResponse(t)||e&&e(t)},error:function(t){n&&n(),handlePostJsonError(t)},complete:function(){t.loadingEl&&S_loading.hide(),t.bindDisabled&&setTimeout(function(){var e=$(t.bindDisabled);if(e.length>0){try{e.attr("disabled",!1)}catch(t){}try{e.prop("disabled",!1)}catch(t){}}},1e3)}})},postJson:function(t,e,n){$.ajax({type:"POST",url:t.url,cache:!1,async:null==t.async||t.async,data:JSON.stringify(t.postData),contentType:"application/json",beforeSend:function(){if(t.loadingEl&&S_loading.show(t.loadingEl),t.bindDisabled){var e=$(t.bindDisabled);if(e.length>0){try{e.attr("disabled",!0)}catch(t){}try{e.prop("disabled",!0)}catch(t){}}}},success:function(t){handleResponse(t)||e&&e(t)},error:function(t){n&&n(),handlePostJsonError(t)},complete:function(){t.loadingEl&&S_loading.hide(),t.bindDisabled&&setTimeout(function(){var e=$(t.bindDisabled);if(e.length>0){try{e.attr("disabled",!1)}catch(t){}try{e.prop("disabled",!1)}catch(t){}}},1e3)}})}},countDigits=function(t,e){var n=(t-0).toString().split("."),a=0;return n.length>1&&(a=n[1].length<e?n[1].length:e),a},doMath={accSub:function(t,e){var n,a,i,o;try{n=t.toString().split(".")[1].length}catch(t){n=0}try{a=e.toString().split(".")[1].length}catch(t){a=0}return i=Math.pow(10,Math.max(n,a)),o=n>=a?n:a,((t*i-e*i)/i).toFixed(o)},accAdd:function(t,e){var n,a,i;try{n=t.toString().split(".")[1].length}catch(t){n=0}try{a=e.toString().split(".")[1].length}catch(t){a=0}return i=Math.pow(10,Math.max(n,a)),(t*i+e*i)/i}};Number.prototype.sub=function(t){return parseFloat(doMath.accSub(this,t))},Number.prototype.add=function(t){return parseFloat(doMath.accAdd(this,t))};var restApi={url_loginSubmit:window.rootPath+"/account/login",url_getAuthenticationPage:window.rootPath+"/orgAuth/getAuthenticationPage",url_authorizeAuthentication:window.rootPath+"/orgAuth/authorizeAuthentication",url_historyData_importProjects:window.rootPath+"/historyData/importProjects"};!function(){function t(t,e){return(/string|function/.test(typeof e)?r:s)(t,e)}function e(t,n){return"string"!=typeof t&&(n=typeof t,"number"===n?t+="":t="function"===n?e(t.call(t)):""),t}function n(t){return u[t]}function a(t){return e(t).replace(/&(?![\w#]+;)|[<>"']/g,n)}function i(t,e){if(p(t))for(var n=0,a=t.length;n<a;n++)e.call(t,t[n],n,t);else for(n in t)e.call(t,t[n],n)}function o(t,e){var n=/(\/)[^\/]+\1\.\.\1/,a=("./"+t).replace(/[^\/]+$/,""),i=a+e;for(i=i.replace(/\/\.\//g,"/");i.match(n);)i=i.replace(n,"/");return i}function s(e,n){var a=t.get(e)||l({filename:e,name:"Render Error",message:"Template not found"});return n?a(n):a}function r(t,e){if("string"==typeof e){var n=e;e=function(){return new c(n)}}var a=d[t]=function(n){try{return new e(n,t)+""}catch(t){return l(t)()}};return a.prototype=e.prototype=f,a.toString=function(){return e+""},a}function l(t){var e="{Template Error}",n=t.stack||"";if(n)n=n.split("\n").slice(0,2).join("\n");else for(var a in t)n+="<"+a+">\n"+t[a]+"\n\n";return function(){return"object"==typeof console&&console.error(e+"\n\n"+n),e}}var d=t.cache={},c=this.String,u={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},p=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)},f=t.utils={$helpers:{},$include:function(t,e,n){return t=o(n,t),s(t,e)},$string:e,$escape:a,$each:i},g=t.helpers=f.$helpers;t.get=function(t){return d[t.replace(/^\.\//,"")]},t.helper=function(t,e){g[t]=e},"function"==typeof define?define(function(){return t}):"undefined"!=typeof exports?module.exports=t:this.template=t,t.helper("_url",function(t){return window.rootPath+t}),t.helper("_isNullOrBlank",function(t){return void 0===t||null===t||_.isBlank(t)}),t.helper("_formatFileSize",function(t){var e;return void 0===t||null===t?"":t<1024?t+"B":t<1048576?(e=parseFloat(t/1024).toFixed(3),e.substring(0,e.length-1)+"KB"):t<1073741824?(e=parseFloat(t/1048576).toFixed(3),e.substring(0,e.length-1)+"MB"):(e=parseFloat(t/1073741824).toFixed(3),e.substring(0,e.length-1)+"GB")}),t.helper("_isNowDiffTargetDateNDaysMore",function(t,e){return moment().diff(moment(t),"days")+1>=e}),t("m_common/m_popover",function(t,e){"use strict";var n=this,a=(n.$helpers,n.$escape),i=t.popoverStyle,o=n.$string,s=t.titleHtml,r=t.contentStyle,l=t.content,d="";return d+='<div class="popover m-popover box-shadow" role="tooltip" style="',d+=a(i),d+='"> <div class="arrow" style="left: 50%;"></div>  ',d+=o(s),d+=' <div class="popover-content" style="',d+=a(r),d+='"> ',d+=o(l),d+=" </div> </div>",new c(d)}),t("m_common/m_popover_confirm",function(t,e){"use strict";var n=this,a=(n.$helpers,n.$string),i=t.confirmMsg,o="";return o+='<div> <p class="f-s-13">',o+=a(i),o+='</p> <p class="pull-right" > <button type="button" class="popover-btn-no btn btn-default btn-xs m-popover-close" style="line-height:22px;">取消 </button> <button type="button" class="popover-btn-yes btn btn-success btn-xs m-popover-submit" style="line-height:22px;">确定</button> </p> </div>',new c(o)}),t("m_common/m_sidebar",function(t,e){"use strict";var n=this,a=n.$helpers,i=n.$escape,o=a._url,s="";return s+='  <div class="page-sidebar navbar-collapse collapse">        <ul class="page-sidebar-menu" data-keep-expanded="false" data-auto-scroll="true" data-slide-speed="200">  <li class="heading"> <h3 class="uppercase">企业认证</h3> </li> <li class="nav-item"> <a href="',s+=i(o("/orgAuth/approveList")),s+='" class="nav-link" data-nav-id="orgAuth-approveList"> <i class="icon-briefcase"></i> <span class="title">认证审核</span> <span class="selected"></span> </a> </li> <li class="heading"> <h3 class="uppercase">历史数据</h3> </li> <li class="nav-item"> <a href="',s+=i(o("/historyData/entry")),s+='" class="nav-link" data-nav-id="historyData-entry"> <i class="icon-briefcase"></i> <span class="title">导入</span> </a> </li>  </ul> </div>',new c(s)}),t("m_orgAuth/m_orgAuth_list",'<div class="page-content" style="padding-top: 0;">  <div class="row"> <div class="col-md-12"> <div class="portlet light" style="overflow: hidden;"> <div class="portlet-title"> <div class="caption">  <span class="caption-subject bold font-yellow-casablanca uppercase">企业认证审核</span> </div> <div class="actions"> <a class="btn btn-circle btn-icon-only btn-default fullscreen" href="javascript:void(0);"> </a> </div> <div class="inputs" style="margin-right: 10px;"> <div class="portlet-input input-inline input-medium"> <div class="input-group"> <input type="text" class="form-control input-circle-left search-input" placeholder="请输入关键字"> <span class="input-group-btn"> <button class="btn btn-circle-right btn-default" data-action="search">搜索</button> </span> </div> </div> </div> </div> <div class="portlet-body"> <table class="table table-striped table-bordered table-hover" id="list"> <thead> <tr> <th>序号</th> <th>组织名称</th> <th>企业名称</th> <th>证件类型</th> <th>注册号/统一社会代码</th> <th>法人</th> <th>经办人</th> <th name="field_applyDate">认证时间</th> <th class="text-center">审核状态</th> <th>审核人</th> <th name="field_auditDate">审核时间</th> </tr> </thead> <tbody class="m-page-data"> </tbody> </table> </div> <div class="clearfix"></div> <div id="orgAuthList_sortSwap"></div> <div class="m-page pull-right" style="margin-bottom: 20px;"></div> </div> </div> </div> </div>'),t("m_orgAuth/m_orgAuth_list_row",function(t,e){"use strict";var n=this,a=n.$helpers,i=n.$each,o=t.list,s=(t.o,t.i,n.$escape),r=t.pageIndex,l=t.pageSize,d=a._isNullOrBlank,u=a._isNowDiffTargetDateNDaysMore,p="";return i(o,function(t,e){p+=' <tr class="odd gradeX"> <td>',p+=s(r*l+e+1),p+="</td> <td>",p+=s(t.orgAlias),p+="</td> <td>",p+=s(t.orgName),p+='</td> <td style="width: 150px;max-width: 150px;"> ',0===t.businessLicenseType?p+=" 普通营业执照 ":1===t.businessLicenseType&&(p+=" 多证合一营业执照 "),p+=" ",d(t.legalRepresentativePhoto)||(p+=' <a href="javascript:void(0);" data-action="preview" data-url="',p+=s(t.legalRepresentativePhoto),p+='"><i class="fa fa-file-image-o"></i></a> '),p+=" </td> <td>",p+=s(t.businessLicenseNumber),p+='</td> <td style="width: 80px;max-width: 80px;"> ',p+=s(t.legalRepresentative),p+=" ",d(t.businessLicensePhoto)||(p+=' <a href="javascript:void(0);" data-action="preview" data-url="',p+=s(t.businessLicensePhoto),p+='"><i class="fa fa-file-image-o"></i></a> '),p+=' </td> <td style="width: 80px;max-width: 80px;"> ',p+=s(t.operatorName),p+=" ",d(t.operatorPhoto)||(p+=' <a href="javascript:void(0);" data-action="preview" data-url="',p+=s(t.operatorPhoto),p+='"><i class="fa fa-file-image-o"></i></a> '),p+=' </td> <td style="width: 120px;max-width: 120px;"> ',1===t.authenticationStatus&&u(t.applyDate,3)?(p+=' <span style="color: red;">',p+=s(t.applyDate),p+="</span> "):(p+=" ",p+=s(t.applyDate),p+=" "),p+=" ",d(t.sealPhoto)||(p+=' <a href="javascript:void(0);" data-action="preview" data-url="',p+=s(t.sealPhoto),p+='"><i class="fa fa-file-image-o"></i></a> '),p+=' </td> <td style="width: 90px;max-width: 90px;padding-left:15px;padding-right: 15px;"> ',0===t.authenticationStatus?p+=' <span class="label label-sm label-warning span-tag-60-25" style="width: 60px;">未提交</span> ':1===t.authenticationStatus?(p+=' <div class="btn-toolbar"> <div class="btn-group"> <button class="btn btn-xs btn-info dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" style="width: 60px;"> 审核 </button> <ul class="dropdown-menu dropdown-menu-left dropdown-menu-v1" role="menu"> <li> <a href="javascript:void(0);" data-action="audit_pass" data-id="',p+=s(t.id),p+='">通过</a> </li> <li> <a href="javascript:void(0);" data-action="audit_reject" data-id="',p+=s(t.id),p+='">不通过</a> </li> </ul> </div> </div> '):2===t.authenticationStatus?(p+='  <div class="btn-toolbar"> <div class="btn-group"> <button class="btn btn-xs btn-success dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" style="width: 60px;"> 已通过 </button> <ul class="dropdown-menu dropdown-menu-left dropdown-menu-v1" role="menu"> <li> <a href="javascript:void(0);" data-action="audit_reject" data-id="',p+=s(t.id),p+='">重置为不通过</a> </li> </ul> </div> </div> '):3===t.authenticationStatus&&(p+='  <div class="btn-toolbar"> <div class="btn-group"> <button class="btn btn-xs btn-danger dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" style="width: 60px;"> 不通过 </button> <ul class="dropdown-menu dropdown-menu-left dropdown-menu-v1" role="menu"> <li> <a href="javascript:void(0);" data-action="audit_view" data-id="',p+=s(t.id),p+='" data-reject-type="',p+=s(t.rejectType),p+='" data-reject-reason="',p+=s(t.rejectReason),p+='" data-auditor-name="',p+=s(t.auditorName),p+='">查看原因</a> </li> <li> <a href="javascript:void(0);" data-action="audit_pass" data-id="',p+=s(t.id),p+='">重置为通过</a> </li> </ul> </div> </div> '),p+=" </td> <td>",p+=s(t.auditorName),p+="</td> <td>",p+=s(t.auditDate),p+="</td> </tr> "}),new c(p)}),t("m_orgAuth/m_orgAuth_reject",'<div class="portlet light" style="overflow: hidden;"> <div class="portlet-title"> <div class="caption">  <span class="caption-subject bold font-yellow-casablanca uppercase">不通过原因</span> </div> <div class="tools"> <a href="" class="remove" data-original-title="" title=""> </a> </div> </div> <div class="portlet-body"> <form class="form-horizontal" role="form"> <div class="form-body"> <div class="form-group"> <label class="col-md-2 control-label">原因：</label> <div class="col-md-9"> <select id="rejectType"></select> </div> </div> <div class="form-group"> <label class="col-md-2 control-label">说明：</label> <div class="col-md-9"> <textarea id="rejectReason" class="form-control" rows="5"></textarea> </div> </div> </div> </form> </div> <div class="modal-footer"> <button type="button" class="btn btn-success" data-action="layer-custom-btn-yes">确&nbsp;定</button> <button type="button" class="btn btn-default" data-action="layer-custom-btn-close">取&nbsp;消</button> </div> </div>'),t("m_orgAuth/m_orgAuth_view",'<div class="portlet light" style="overflow: hidden;"> <div class="portlet-title"> <div class="caption">  <span class="caption-subject bold font-yellow-casablanca uppercase">不通过原因</span> </div> <div class="tools"> <a href="" class="remove" data-original-title="" title=""> </a> </div> </div> <div class="portlet-body"> <form class="form-horizontal" role="form"> <div class="form-body"> <div class="form-group"> <label class="col-md-2 control-label">原因：</label> <div class="col-md-9"> <select id="rejectType"></select> </div> </div> <div class="form-group"> <label class="col-md-2 control-label">说明：</label> <div class="col-md-9"> <textarea id="rejectReason" class="form-control" rows="5"></textarea> </div> </div> </div> </form> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-action="layer-custom-btn-close">关&nbsp;闭</button> </div> </div>'),t("m_upload/m_uploadmgr",'<div class="uploadmgr tag-box tag-box-v1 box-shadow shadow-effect-1"> <div class="alertmgr"></div> <a href="javascript:void(0)" class="btn-select btn-u btn-u-sm btn-u-orange rounded" type="button"><i class="fa fa-plus"></i>&nbsp;选择文件</a> <a href="javascript:void(0)" class="btn-start btn-u btn-u-sm btn-u-green2 rounded dp-none" type="button"><i class="fa fa-caret-right"></i>&nbsp;开始</a> <a href="javascript:void(0)" class="btn-stop btn-u btn-u-sm btn-u-red rounded dp-none" type="button"><i class="fa fa-times"></i>&nbsp;停止</a> <a href="javascript:void(0)" type="button" class="btn-close close">×</a> <div class="upload-item-list"> </div> <p class="pull-right"></p> </div>'),t("m_upload/m_uploadmgr_uploadItem",function(t,e){"use strict";var n=this,a=(n.$helpers,n.$escape),i=t.file,o=t.pid,s="";return s+='<div class="uploadItem uploadItem_',s+=a(i.id),s+='" data-fileId="',s+=a(i.id),s+='" data-pid="',s+=a(o),s+='"> <button type="button" class="close removefile">×</button> <h3 class="heading-xs">',s+=a(i.name),s+='<span style="padding-left:5px;" class="span_progress"></span> <span class="span_status pull-right m-r-sm"></span></h3> <div class="progress progress-u progress-xs"> <div class="progress-bar progress-bar-u" role="progressbar" name="div_progress" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"> </div> </div> </div>',new c(s)})}(),function(t,e,n,a){"use strict";function i(t,e){this.element=t,this.settings=e,this._defaults=s,this._name=o,this._popoverTop=null,this._popoverHeight=null,this.init()}var o="m_popover",s={clearOnInit:!0,titleHtml:null,hideArrow:!1,popoverStyle:"",contentStyle:"padding: 10px 14px 10px;",content:null,placement:null,onShown:null,onSave:null,onClear:null,onClose:null,template:"m_common/m_popover",closeOnDocumentClicked:null};t.extend(i.prototype,{init:function(){var e=this;!0===e.settings.clearOnInit&&(t(n).find(".m-popover").each(function(e,n){t(n).remove()}),t(n).off("click.m-popover"));var a=template(e.settings.template,{titleHtml:e.settings.titleHtml,popoverStyle:e.settings.popoverStyle,contentStyle:e.settings.contentStyle,content:e.settings.content});t(a).insertAfter(t(e.element));var i=t(e.element).next(".m-popover");!0===e.settings.hideArrow&&i.find(".arrow").eq(0).hide(),e.settings.onShown&&null!==e.settings.onShown&&e.settings.onShown(i),i.off("click.m-popover").on("click.m-popover",function(t){return stopPropagation(t),!1}),setTimeout(function(){e.setPosition(),e.bindBtnClick(),e.bindPopoverClickedOut()},50),i.find('input[type="text"]').keydown(function(){if("13"==event.keyCode){var t=i.find(".m-popover-submit");t&&t.length>0&&t.click()}})},bindPopoverClickedOut:function(){var e=this;t(n).on("click.m-popover",function(n){var a=t(n.target).parents(".select2-container").length>0||t(n.target).is(".select2-container");return!(t(n.target).closest(".select2-search__field").length>0||a)&&(("function"!=typeof e.settings.closeOnDocumentClicked||!1!==e.settings.closeOnDocumentClicked(n))&&void(e.settings.onClose&&null!==e.settings.onClose?!1!==e.settings.onClose(t(n.target))&&e.closeFilter():e.closeFilter()))})},setPosition:function(){var e=this,n=t(e.element).next(".m-popover");if(n.length>0){var a=e.settings.placement?e.settings.placement:"top",i=t(e.element).position().top,o=t(e.element).outerWidth(),s=t(e.element).outerHeight(),r=t(e.element).position().left,l=n.width(),d=n.outerHeight(),c=0,u=0;switch(a){case"top":c=i-d,u=r+o/2-l/2;break;case"bottom":c=i+s,u=r+o/2-l/2;break;case"left":c=i-d/2+5,u=r-l-10;break;case"right":c=i-d/2+7,u=r+o}e._popoverTop=c,e._popoverHeight=d,n.removeClass("top").addClass(a),(a.indexOf("left")>-1||a.indexOf("right")>-1)&&n.find(".arrow").css({top:"50%",left:""}),n.css({display:"inline-block",position:"absolute",top:c,left:u})}},bindBtnClick:function(){var e=this,n=t(e.element).next(".m-popover");if(n.length>0){var a=n.find(".m-popover-submit");a.length>0&&a.click(function(t){return e.settings.onSave&&null!==e.settings.onSave?!1!==e.settings.onSave(n)&&e.closeFilter():e.closeFilter(),stopPropagation(t),!1});var i=n.find(".m-popover-clear");i.length>0&&i.click(function(a){if(e.settings.onClear&&null!==e.settings.onClear)e.settings.onClear(n);else{var i=t(this).closest("form").find("input:first");i.length>0&&i.val("")}return stopPropagation(a),!1});var o=n.find(".m-popover-close");o.length>0&&o.click(function(t){return e.settings.onClose&&null!==e.settings.onClose?!1!==e.settings.onClose(n)&&e.closeFilter():e.closeFilter(),stopPropagation(t),!1}),n.resize(function(){setTimeout(function(){e.changePosition(n)},20)})}},changePosition:function(t){var e=this,n=t.find("label.error").length,a=(t.find("label.error").outerHeight(),t.height()),i=(t.position().top,a-e._popoverHeight);if(null!=e.settings.placement&&"top"==e.settings.placement)if(-4==i)t.css("top",e._popoverTop+"px");else{var o=e._popoverTop-i-4;t.css("top",o)}else null==e.settings.placement||"left"!=e.settings.placement&&"right"!=e.settings.placement||t.find(".arrow").css("top",e._popoverHeight/2+"px")},closeFilter:function(){t(this.element).siblings(".m-popover").each(function(e,n){t(n).remove()}),t(n).off("click.m-popover")}}),t.fn[o]=function(e,n){var a,r,l=this.each(function(){if(a=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?a=new i(this,l):void 0!==a&&null!==a||(a=new i(this,l)),t.data(this,"plugin_"+o,a)}else"string"==typeof e&&"function"==typeof a[e]&&(r=a[e].call(a,n))});return void 0===r?l:r}}(jQuery,window,document),function(t,e,n,a){"use strict";function i(t,e){this.element=t,this.settings=e,this._defaults=s,this._name=o,this.init()}var o="m_sidebar",s={};t.extend(i.prototype,{init:function(){this._render()},_render:function(){var e=this,n=template("m_common/m_sidebar",{});t(e.element).html(n),e._bindAction()},_bindAction:function(){var e=this,n=t(e.element).attr("data-nav-id");t(e.element).find("a.nav-link").each(function(e,a){var i=t(a);i.attr("data-nav-id")===n&&i.closest(".nav-item").addClass("active open")})}}),t.fn[o]=function(e,n){var a,r,l=this.each(function(){if(a=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?a=new i(this,l):void 0!==a&&null!==a||(a=new i(this,l)),t.data(this,"plugin_"+o,a)}else"string"==typeof e&&"function"==typeof a[e]&&(r=a[e].call(a,n))});return void 0===r?l:r}}(jQuery,window,document),function(t,e,n,a){"use strict";function i(t,e){this.element=t,this.settings=e,this._defaults=s,this._name=o,this._rejectReasons=[{id:1,text:"企业认证名称与营业执照不符"},{id:2,text:"营业执照复印件无盖红章"},{id:3,text:"营业执照复印件无签署文字“仅用于卯丁认证使用"},{id:4,text:"营业执照过期"},{id:5,text:"营业执照图片模糊"},{id:6,text:"法人身份证与营业执照不符合"},{id:7,text:"法人身份证图片模糊"},{id:8,text:"法人身份证已过期"},{id:8,text:"经办人身份证图片模糊"},{id:9,text:"经办人身份证已过期"},{id:10,text:"证照无法查验"}],this.init()}var o="m_orgAuth",s={};t.extend(i.prototype,{init:function(){this._render()},_render:function(){var e=this,n=template("m_orgAuth/m_orgAuth_list",{});t(e.element).html(n),e._bindPage(),e._bindSearch(),e._bindSortFields()},_bindPage:function(){var e=this,n=t(e.element).find(".m-page:first"),a=e._remote();n.m_page({loadingEl:t(e.element).find(".portlet"),pageSize:20,remote:a},!0)},_remote:function(){var e=this,n=t(e.element).find(".m-page:first"),a=function(n){var a={pageIndex:n.pageIndex,pageSize:n.pageSize},i=t(e.element).find(".search-input").val();isNullOrBlank(i)||t.extend(!0,a,{orgNameMask:i,orgAliasMask:i});var o=t("#orgAuthList_sortSwap").attr("data-sortField");if(!isNullOrBlank(o))if("applyDate"===o){var s=t("#orgAuthList_sortSwap").attr("data-sortType");"asc"===s?t.extend(!0,a,{orderCondition:{applyDate:1}}):"desc"===s&&t.extend(!0,a,{orderCondition:{applyDate:-1}})}else if("auditDate"===o){var s=t("#orgAuthList_sortSwap").attr("data-sortType");"asc"===s?t.extend(!0,a,{orderCondition:{auditDate:1}}):"desc"===s&&t.extend(!0,a,{orderCondition:{auditDate:-1}})}return a};return{url:restApi.url_getAuthenticationPage,pageParams:a,success:function(a){if("0"==a.code){var i={};i.pageIndex=n.pagination("getPageIndex"),i.pageSize=n.pagination("getPageSize"),i.list=a.data.list;var o=template("m_orgAuth/m_orgAuth_list_row",i);t(e.element).find(".m-page-data").html(o),e._bindAudit(),e._bindAttachPreview()}else S_toastr.error(a.msg)}}},_refreshList:function(e){var n=this,a=t(n.element).find(".m-page:first"),i=a.pagination("getPageIndex");!0===e&&(i=0),a.pagination("setPageIndex",i).pagination("setParams",{}).pagination("remote")},_bindSearch:function(){var e=this;t(e.element).find('button[data-action="search"]').click(function(){e._refreshList(!0)})},_bindSortFields:function(){var e=this,n=function(t,n){e._refreshList(!0)};t('th[name="field_applyDate"]').m_sortableField({swapId:"#orgAuthList_sortSwap",field:"applyDate",onChanged:n},!0),t('th[name="field_auditDate"]').m_sortableField({swapId:"#orgAuthList_sortSwap",field:"auditDate",onChanged:n},!0)},_bindAudit:function(){var n=this;t(n.element).find('a[data-action="audit_pass"]').click(function(){var a=t(this);S_swal.confirm({title:"您确定要批准通过该认证吗？"},function(t){if(t){var i={url:restApi.url_authorizeAuthentication,postData:{id:a.attr("data-id"),authenticationStatus:2,auditorName:e.currentAccountName}};m_ajax.postJson(i,function(t){"0"===t.code?(S_toastr.success("提交成功"),n._refreshList()):S_toastr.error(t.msg)})}})}),t(n.element).find('a[data-action="audit_reject"]').click(function(){var a=t(this);S_layer.panel({area:["700px","340px"],content:template("m_orgAuth/m_orgAuth_reject",{}),zIndex:100,shown:function(e,a){t("#rejectType").m_select2_localData({width:"495px",data:n._rejectReasons},!0)},yes:function(t,i){var o={url:restApi.url_authorizeAuthentication,loadingEl:i.find(".portlet"),postData:{id:a.attr("data-id"),authenticationStatus:3,auditorName:e.currentAccountName,rejectType:i.find("#rejectType").val(),rejectReason:i.find("#rejectReason").val()}};m_ajax.postJson(o,function(e){"0"===e.code?(S_toastr.success("提交成功"),n._refreshList(),layer.close(t)):S_toastr.error(e.msg)})}})}),t(n.element).find('a[data-action="audit_view"]').click(function(){var e=t(this);S_layer.panel({area:["700px","340px"],content:template("m_orgAuth/m_orgAuth_view",{}),zIndex:100,shown:function(a,i){t("#rejectType").m_select2_localData({width:"495px",data:n._rejectReasons},!0),t("#rejectType").val(e.attr("data-reject-type")).trigger("change").prop("disabled",!0),i.find("#rejectReason").val(e.attr("data-reject-reason")).prop("readonly",!0)}})})},_bindAttachPreview:function(){var e=this;t.each(t(e.element).find('a[data-action="preview"]'),function(e,n){t(n).off("click.preview").on("click.preview",function(){var e=t(this),n=[];n.push({alt:null,pid:null,src:e.attr("data-url")});var a=e.closest("tr");console.log(a),t.each(a.find('a[data-action="preview"]'),function(a,i){var o=t(i);o.attr("data-url")!==e.attr("data-url")&&n.push({alt:null,pid:null,src:o.attr("data-url")})});var i={title:"企业认证附件",id:1,start:0,data:n};layer.photos({photos:i,shift:5})})})}}),t.fn[o]=function(e,n){var a,r,l=this.each(function(){if(a=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?a=new i(this,l):void 0!==a&&null!==a||(a=new i(this,l)),t.data(this,"plugin_"+o,a)}else"string"==typeof e&&"function"==typeof a[e]&&(r=a[e].call(a,n))});return void 0===r?l:r}}(jQuery,window,document),function(t,e,n,a){"use strict";function i(e,n){this.element=e;var a=t.extend({},s.remote,n.remote);this.settings=n,this.settings.remote=a,this._defaults=s,this._name=o,this.init()}var o="m_page",s={
loadingEl:null,pageIndex:0,pageSize:10,total:0,pageBtnCount:5,showFirstLastBtn:!1,firstBtnText:null,lastBtnText:null,prevBtnText:"上一页",nextBtnText:"下一页",loadFirstPage:!0,remote:{url:null,params:null,pageParams:null,success:null,beforeSend:null,complete:null,pageIndexName:"pageIndex",pageSizeName:"pageSize",totalName:"data.total",traditional:!1,remoteWrongFormat:null},pageElementSort:["$page","$size","$jump","$info"],showInfo:!1,infoFormat:"{start} ~ {end} of {total} entires",noInfoText:"0 entires",showJump:!1,jumpBtnText:"Go",showPageSizes:!1,pageSizeItems:[5,10,15,20],debug:!1};t.extend(i.prototype,{init:function(){var e=this;null!==e.settings.loadingEl&&null===e.settings.remote.beforeSend&&(e.settings.remote.beforeSend=function(){App.blockUI({target:e.settings.loadingEl,boxed:!1,animate:!0})}),null!==e.settings.loadingEl&&null===e.settings.remote.complete&&(e.settings.remote.complete=function(){App.unblockUI(e.settings.loadingEl)}),null===e.settings.remote.remoteWrongFormat&&(e.settings.remote.remoteWrongFormat=function(t){t&&"500"===t.code&&S_toastr.error("很抱歉，请求发生异常")}),t(e.element).pagination()&&t(e.element).pagination("destroy"),t(e.element).pagination(e.settings)}}),t.fn[o]=function(e,n){var a,r,l=this.each(function(){if(a=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?a=new i(this,l):void 0!==a&&null!==a||(a=new i(this,l)),t.data(this,"plugin_"+o,a)}else"string"==typeof e&&"function"==typeof a[e]&&(r=a[e].call(a,n))});return void 0===r?l:r}}(jQuery,window,document),function(t,e,n,a){"use strict";function i(t,e){this.element=t,this.settings=e,this._defaults=s,this._name=o,this.init()}var o="m_select2_localData",s={allowClear:!1,language:"zh-CN",minimumResultsForSearch:1/0,data:[]};t.extend(i.prototype,{init:function(){var e=this;t(e.element).select2(e.settings)}}),t.fn[o]=function(e,n){var a,r,l=this.each(function(){if(a=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?a=new i(this,l):void 0!==a&&null!==a||(a=new i(this,l)),t.data(this,"plugin_"+o,a)}else"string"==typeof e&&"function"==typeof a[e]&&(r=a[e].call(a,n))});return void 0===r?l:r}}(jQuery,window,document),function(t,e,n,a){"use strict";function i(e,n){this.element=e,this.settings=n,this._defaults=s,this._name=o,this.settings.field=this.settings.field||t(this.element).attr("name"),this.init()}var o="m_sortableField",s={swapId:null,field:null,sortType:"",onChanged:null};t.extend(i.prototype,{init:function(){var t=this;t._render(),t._bindClick()},_render:function(){var e=this,n=t(e.element);if(n.addClass("field-sortable"),n.append('<span class="field-sort-indicator"></span>'),e.settings.swapId&&null!==e.settings.swapId){var a=t(e.settings.swapId);if(a.length>0&&a.attr("data-sortField")===e.settings.field){var i=a.attr("data-sortType");e.settings.sortType=i,"asc"===i?n.addClass("field-sorted-asc"):"desc"===i&&n.addClass("field-sorted-desc"),n.closest("th").siblings().each(function(e,n){var a=t(n);a.removeClass("field-sorted-asc"),a.removeClass("field-sorted-desc")})}}},_bindClick:function(){var e=this,n=t(e.element);n.find(".field-sort-indicator").click(function(){switch(n.removeClass("field-sorted-asc"),n.removeClass("field-sorted-desc"),n.closest("th").siblings().each(function(e,n){var a=t(n);a.removeClass("field-sorted-asc"),a.removeClass("field-sorted-desc")}),e.settings.sortType){case"":e.settings.sortType="asc",t(e.element).addClass("field-sorted-asc");break;case"asc":e.settings.sortType="desc",t(e.element).addClass("field-sorted-desc");break;case"desc":e.settings.sortType=""}if(e.settings.swapId&&null!==e.settings.swapId){var a=t(e.settings.swapId);a.length>0&&(isNullOrBlank(e.settings.sortType)?(a.removeAttr("data-sortField"),a.removeAttr("data-sortType")):(a.attr("data-sortField",e.settings.field),a.attr("data-sortType",e.settings.sortType)))}e.settings.onChanged&&null!==e.settings.onChanged&&e.settings.onChanged(e.settings.field,e.settings.sortType)})}}),t.fn[o]=function(e,n){var a,r,l=this.each(function(){if(a=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?a=new i(this,l):void 0!==a&&null!==a||(a=new i(this,l)),t.data(this,"plugin_"+o,a)}else"string"==typeof e&&"function"==typeof a[e]&&(r=a[e].call(a,n))});return void 0===r?l:r}}(jQuery,window,document),function(t,e,n,a){"use strict";function i(t,e){this.element=t,this.settings=e,this._defaults=s,this._name=o,this._lastUploadFile=null,this._uploader=null,this.init()}var o="m_fileUploader",s={server:null,auto:!0,chunked:!1,chunkSize:5242880,chunkRetry:3,fileExts:"pdf,zip,rar,doc,docx,xls,xlsx,ppt,pptx,txt",fileSingleSizeLimit:null,formData:{},uploadBeforeSend:null,uploadSuccessCallback:null,uploadProgressCallback:null,loadingId:null};t.extend(i.prototype,{init:function(){this._initWebUploader()},_initWebUploader:function(){var t=this;t._uploader=WebUploader.create({fileSingleSizeLimit:t.settings.fileSingleSizeLimit,compress:!1,auto:t.settings.auto,swf:e.rootPath+"/assets2/lib/webuploader/Uploader.swf",server:t.settings.server,pick:{id:t.element,innerHTML:t.settings.innerHTML||"上传",multiple:!1},duplicate:!0,resize:!1,chunked:t.settings.chunked,chunkSize:t.settings.chunkSize,chunkRetry:t.settings.chunkRetry,formData:t.settings.formData,accept:t.settings.accept||{extensions:t.settings.fileExts},threads:1,disableGlobalDnd:!0}),t._uploader.on("beforeFileQueued",function(e){return _.isBlank(e.ext)?(S_toastr.error(e.name+" 缺少扩展名，无法加入上传队列"),!1):!t._uploader.isInProgress()&&(t._uploader.reset(),!0)}),t._uploader.on("fileQueued",function(e){t._lastUploadFile=e,t._uploader.option("formData",{uploadId:WebUploader.Base.guid()})}),t._uploader.on("startUpload",function(e){isNullOrBlank(t.settings.loadingId)||S_loading.show(t.settings.loadingId,"正在上传中...")}),t._uploader.on("uploadStart",function(t){}),t._uploader.on("uploadProgress",function(e,n){null!=t.settings.uploadProgressCallback&&t.settings.uploadProgressCallback(e,n)}),t._uploader.on("uploadBeforeSend",function(e,n,a){!0===t.settings.chunked&&(n.chunkPerSize=t.settings.chunkSize),t.settings.uploadBeforeSend&&t.settings.uploadBeforeSend(e,n,a)}),t._uploader.on("uploadAccept",function(e,n){if(!handleResponse(n)&&n.code){if("0"===n.code&&n.data)return!0===n.data.needFlow&&(t._uploader.options.formData.fastdfsGroup=n.data.fastdfsGroup,t._uploader.options.formData.fastdfsPath=n.data.fastdfsPath),!0;var a=null!=n.msg&&void 0!=n.msg?n.msg:null!=n.info&&void 0!=n.info?n.info:"";e&&e.file&&e.file.name?(e.file.uploadAcceptFailed=!0,e.file.uploadAcceptFailedMsg=a):t._onError(null,"上传失败(#02)，"+a)}return!1}),t._uploader.on("uploadSuccess",function(e,n){if(isNullOrBlank(t.settings.loadingId)||S_loading.hide(t.settings.loadingId),!handleResponse(n))if("0"===n.code)t.settings.uploadSuccessCallback&&t.settings.uploadSuccessCallback(e,n);else{var a=null!=n.msg&&void 0!=n.msg?n.msg:null!=n.info&&void 0!=n.info?n.info:"";t._onError(e,a)}}),t._uploader.on("uploadFinished",function(){}),t._uploader.on("uploadError",function(e,n){isNullOrBlank(t.settings.loadingId)||S_loading.hide(t.settings.loadingId),!0===e.uploadAcceptFailed?t._onError(e,e.uploadAcceptFailedMsg):t._onError(e,"上传失败，"+n)}),t._uploader.on("error",function(e){var n;switch(e){case"F_EXCEED_SIZE":n="文件大小超出范围（"+t.settings.fileSingleSizeLimit/1048576+"MB）";break;case"Q_EXCEED_NUM_LIMIT":n="已超最大的文件上传数";break;case"Q_TYPE_DENIED":n="仅支持上传如下类型文件："+t.settings.fileExts;break;case"F_DUPLICATE":n="文件已经添加";break;default:n="文件添加失败"}t._onError(t._lastUploadFile,n)})},_onError:function(t,e){var n=this;void 0!==t&&null!==t&&t.setStatus("error"),n._debounceShowError(e)},_debounceShowError:_.debounce(function(t){S_toastr.error(t)},200),getUploader:function(){return this._uploader}}),t.fn[o]=function(e,n){var a,r,l=this.each(function(){if(a=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?a=new i(this,l):void 0!==a&&null!==a||(a=new i(this,l)),t.data(this,"plugin_"+o,a)}else"string"==typeof e&&"function"==typeof a[e]&&(r=a[e].call(a,n))});return void 0===r?l:r}}(jQuery,window,document),function(t,e,n,a){"use strict";function i(t,e){this.element=t,this.settings=e,this._defaults=s,this._name=o,this._lastUploadFile=null,this._uploader=null,this.init()}var o="m_imgUploader",s={server:null,auto:!0,chunked:!1,chunkSize:5242880,chunkRetry:3,fileExts:"gif,jpg,jpeg,bmp,png",fileSingleSizeLimit:null,formData:{},uploadBeforeSend:null,uploadSuccessCallback:null,uploadProgressCallback:null,innerHTML:null,loadingId:null};t.extend(i.prototype,{init:function(){this._initWebUploader()},_initWebUploader:function(){var t=this;t._uploader=WebUploader.create({compress:!1,auto:!0,swf:e.rootPath+"/assets2/lib/webuploader/Uploader.swf",server:t.settings.server,pick:{id:t.element,innerHTML:t.settings.innerHTML||"上传",multiple:!1},duplicate:!0,resize:!1,chunked:!1,formData:t.settings.formData,accept:t.settings.accept||{extensions:t.settings.fileExts},threads:1,disableGlobalDnd:!0}),t._uploader.on("beforeFileQueued",function(e){return _.isBlank(e.ext)?(S_toastr.error(e.name+" 缺少扩展名，无法加入上传队列"),!1):!t._uploader.isInProgress()&&(t._uploader.reset(),!0)}),t._uploader.on("fileQueued",function(e){t._lastUploadFile=e,t._uploader.option("formData",{uploadId:WebUploader.Base.guid()})}),t._uploader.on("startUpload",function(e){isNullOrBlank(t.settings.loadingId)||S_loading.show(t.settings.loadingId,"正在上传中...")}),t._uploader.on("uploadStart",function(t){}),t._uploader.on("uploadProgress",function(t,e){}),t._uploader.on("uploadBeforeSend",function(e,n,a){!0===t.settings.chunked&&(n.chunkPerSize=t.settings.chunkSize),t.settings.uploadBeforeSend&&t.settings.uploadBeforeSend(e,n,a)}),t._uploader.on("uploadAccept",function(e,n){if(!handleResponse(n)&&n.code){if("0"===n.code&&n.data)return!0===n.data.needFlow&&(t._uploader.options.formData.fastdfsGroup=n.data.fastdfsGroup,t._uploader.options.formData.fastdfsPath=n.data.fastdfsPath),!0;e&&e.file&&e.file.name?S_toastr.error(e.file.name+" 上传失败(#01)，"+n.msg):S_toastr.error("上传失败(#02)，"+n.msg)}return!1}),t._uploader.on("uploadSuccess",function(e,n){isNullOrBlank(t.settings.loadingId)||S_loading.hide(t.settings.loadingId),handleResponse(n)||("0"===n.code?t.settings.uploadSuccessCallback&&t.settings.uploadSuccessCallback(e,n):S_toastr.error(n.msg))}),t._uploader.on("uploadFinished",function(){}),t._uploader.on("uploadError",function(e,n){isNullOrBlank(t.settings.loadingId)||S_loading.hide(t.settings.loadingId),t._onError(e,"上传失败，"+n)}),t._uploader.on("error",function(e){var n;switch(e){case"F_EXCEED_SIZE":n="文件大小超出范围";break;case"Q_EXCEED_NUM_LIMIT":n="已超最大的文件上传数";break;case"Q_TYPE_DENIED":n="文件类型不正确，请上传png、jpg、bmp、jpeg格式的图像文件";break;case"F_DUPLICATE":n="文件已经添加";break;default:n="文件添加失败"}t._onError(t._lastUploadFile,n)})},_onError:function(t,e){void 0!==t&&null!==t&&t.setStatus("error"),S_toastr.error(e)}}),t.fn[o]=function(e,n){var a,r,l=this.each(function(){if(a=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?a=new i(this,l):void 0!==a&&null!==a||(a=new i(this,l)),t.data(this,"plugin_"+o,a)}else"string"==typeof e&&"function"==typeof a[e]&&(r=a[e].call(a,n))});return void 0===r?l:r}}(jQuery,window,document),function(t,e,n,a){"use strict";function i(t,e){this.element=t,this.settings=e,this._defaults=s,this._name=o,this._uploader=null,this.init()}var o="m_uploadmgr",s={server:null,auto:!1,chunked:!0,chunkSize:5242880,chunkRetry:3,fileExts:"*",fileSingleSizeLimit:null,btnPickId:null,btnPickText:"上传",formData:{},closeIfFinished:!1,uploadBeforeSend:null,beforeFileQueued:null,uploadSuccessCallback:null};t.extend(i.prototype,{init:function(){this._initWebUploader()},_initWebUploader:function(){var n=this,a=template("m_docmgr/m_uploadmgr",{});t(n.element).html(a),n._uploader=WebUploader.create({fileSingleSizeLimit:n.settings.fileSingleSizeLimit,compress:!1,auto:n.settings.auto,swf:e.rootPath+"/assets2/lib/webuploader/Uploader.swf",server:n.settings.server,pick:{id:".btn-select:eq(0)",innerHTML:null,multiple:!0},duplicate:!1,resize:!1,chunked:n.settings.chunked,chunkSize:n.settings.chunkSize,chunkRetry:n.settings.chunkRetry,formData:n.settings.formData,accept:n.settings.accept||{extensions:n.settings.fileExts},threads:1,disableGlobalDnd:!0}),n._uploader.on("beforeFileQueued",function(t){return _.isBlank(t.ext)?(n._alertError(t.name+" 缺少扩展名，无法加入上传队列"),!1):n._uploader.isInProgress()?(n._alertError("当前正在上传，禁止添加新文件到队列中"),!1):!n.settings.beforeFileQueued||"function"!=typeof n.settings.beforeFileQueued||!1!==n.settings.beforeFileQueued(t,n)}),n._uploader.on("filesQueued",function(e){e&&e.length>0&&(t.each(e,function(e,a){var i=template("m_docmgr/m_uploadmgr_uploadItem",{file:a});t(n.element).find(".upload-item-list:eq(0)").append(i);var o=t(n.element).find(".uploadItem_"+a.id+":eq(0)");o.find(".span_status:eq(0)").html("待上传"),o.find(".removefile:eq(0)").click(function(){return n._uploader.removeFile(o.attr("data-fileId"),!0),o.remove(),!1})}),t(n.element).find(".btn-start:eq(0)").show())}),n._uploader.on("startUpload",function(e){t(n.element).find(".btn-start:eq(0)").hide(),t(n.element).find(".btn-stop:eq(0)").show()}),n._uploader.on("uploadStart",function(e){t(n.element).find(".uploadItem_"+e.id+":eq(0)").find(".span_status:eq(0)").html("正在上传")}),n._uploader.on("uploadProgress",function(e,a){var i=(100*a).toFixed(2);a>=1&&(i=100);var o=t(n.element).find(".uploadItem_"+e.id+":eq(0)");o.find(".span_progress:eq(0)").html(i+"%"),o.find(".progress-bar:eq(0)").attr("aria-valuenow",i).css("width",i+"%")}),n._uploader.on("uploadBeforeSend",function(t,e,a){!0===n.settings.chunked&&(e.chunkPerSize=n.settings.chunkSize),n.settings.uploadBeforeSend&&n.settings.uploadBeforeSend(t,e,a)}),n._uploader.on("uploadAccept",function(t,e){if(!handleResponse(e)&&e.code){if("0"===e.code&&e.data)return!0===e.data.needFlow&&(n._uploader.options.formData.fastdfsGroup=e.data.fastdfsGroup,n._uploader.options.formData.fastdfsPath=e.data.fastdfsPath),!0;t&&t.file&&t.file.name?n._alertError(t.file.name+" 上传失败(#01)，"+e.msg):n._alertError("上传失败(#02)，"+e.msg)}return!1}),n._uploader.on("uploadSuccess",function(e,a){if(!handleResponse(a)){var i=t(n.element).find(".uploadItem_"+e.id+":eq(0)");0==a.code?(i.find(".span_status:eq(0)").html("上传成功"),n._uploader.removeFile(e,!0),n.settings.uploadSuccessCallback&&n.settings.uploadSuccessCallback(e,a)):"1"===a.code?(S_dialog.error(a.msg),i.find(".span_status:eq(0)").html("上传失败")):i.find(".span_status:eq(0)").html("上传失败")}}),n._uploader.on("uploadFinished",function(){t(n.element).find(".btn-start:eq(0)").hide(),t(n.element).find(".btn-stop:eq(0)").hide(),n.settings.closeIfFinished&&setTimeout(function(){t(n.element).find("a.btn-close").click()},500)}),n._uploader.on("uploadError",function(e,a){var i=t(n.element).find(".uploadItem_"+e.id+":eq(0)");i.length>0&&(a?i.find(".span_status:eq(0)").html("上传失败（"+a+"）"):i.find(".span_status:eq(0)").html("上传失败"))}),n._uploader.on("error",function(t){var e;switch(t){case"F_EXCEED_SIZE":e="文件大小超出范围";break;case"Q_EXCEED_NUM_LIMIT":e="已超最大的文件上传数";break;case"Q_TYPE_DENIED":e="仅支持上传如下类型文件："+n.settings.fileExts;break;case"F_DUPLICATE":e="文件已经添加";break;default:e="文件添加失败"}n._alertError(e)}),n._bindAction()},_bindAction:function(){var n=this;t(n.element).find(".btn-start:eq(0)").click(function(){var a=function(){if(null===n._uploader.option("server"))return n._alertError("上传路径没有正确配置"),!1;var e=n._uploader.getFiles();if(!e||0==e.length)return n._alertError("请先选择要上传的文件"),!1;var a=[],i=[];t.each(e,function(t,e){var n=e.getStatus();"error"===n?a.push(e):"interrupt"===n&&i.push(e)}),a.length+i.length>0?(t.each(i,function(t,e){e.setStatus("error")}),n._uploader.retry()):n._uploader.upload()},i={ignoreError:!0,url:restApi.url_getCompanyDiskInfo,postData:{companyId:e.currentCompanyId}};return m_ajax.postJson(i,function(t){if("0"===t.code){parseFloat(t.data.freeSize)<=0?S_toastr.warning("当前组织网盘空间不足，无法上传，请联系客服"):a()}}),!1}),t(n.element).find(".btn-stop:eq(0)").click(function(){var e=n._uploader.getFiles();e&&e.length>0&&t.each(e,function(e,a){a.getStatus();try{n._uploader.stop(a)}catch(t){}if("interrupt"===a.getStatus()){t(n.element).find(".uploadItem_"+a.id+":eq(0)").find(".span_status:eq(0)").html("已中断")}}),t(n.element).find(".btn-stop:eq(0)").hide(),t(n.element).find(".btn-start:eq(0)").show()}),t(n.element).find(".btn-close:eq(0)").click(function(){if(n._uploader.isInProgress())n._alertError("当前正在上传，无法关闭");else{var e=n._uploader.getFiles();e&&e.length>0&&t.each(function(t,e){n._uploader.removeFile(e,!0)}),n._uploader.destroy(),t(n.element).html("")}return!1})},_onError:function(t,e){t.setStatus("error"),this._alertError(t.name+" "+e)},_alertError:function(e,n){var a=this,i=template("m_alert/m_alert_error",{content:e,id:n});t(a.element).find(".alertmgr:eq(0)").append(i)},getUploader:function(){return this._uploader}}),t.fn[o]=function(e,n){var a,r,l=this.each(function(){if(a=t.data(this,"plugin_"+o),void 0===e||null===e||"object"==typeof e){var l=t.extend(!0,{},s,e);!0===n?a=new i(this,l):void 0!==a&&null!==a||(a=new i(this,l)),t.data(this,"plugin_"+o,a)}else"string"==typeof e&&"function"==typeof a[e]&&(r=a[e].call(a,n))});return void 0===r?l:r}}(jQuery,window,document);var historyData_entry={init:function(){this._initAction()},_initAction:function(){$("#btnImportProjects").m_fileUploader({innerHTML:"导入项目",server:restApi.url_historyData_importProjects,formData:{abc:"123"},accept:{title:"请选择Excel文件",extensions:"xlsx,xls",mimeTypes:".xlsx,.xls"},loadingId:"",uploadSuccessCallback:function(t,e){S_toastr.success(e.msg)}})}},login={init:function(){var t=this;t._bindAction(),t._bindKeyDownEnter(),$.backstretch([window.rootPath+"/assets/img/bg/1.jpg",window.rootPath+"/assets/img/bg/2.jpg",window.rootPath+"/assets/img/bg/3.jpg"],{fade:1e3,duration:5e3})},_bindAction:function(){var t=this;$("#btnLogin").click(function(){t._login()})},_bindKeyDownEnter:function(){var t=this;$("#account").keydown(function(e){if(13==event.keyCode)return t._login(),stopPropagation(e),preventDefault(e),!1}),$("#password").keydown(function(e){if(13==event.keyCode)return t._login(),stopPropagation(e),preventDefault(e),!1})},_login:function(){var t=$("#account").val(),e=$("#password").val();if(isNullOrBlank(t)||isNullOrBlank(e))return void S_toastr.warning("账号或密码不能为空");var n={url:restApi.url_loginSubmit,loadingEl:"",postData:{account:t,password:e}};m_ajax.postJson(n,function(t){"0"===t.code?(S_toastr.success("登陆成功，正在跳转..."),setTimeout(function(){window.location.href=window.rootPath+"/orgAuth/approveList"},1e3)):S_toastr.error(t.msg)})}},orgAuth_approveList={init:function(){$(".page-content-wrapper").m_orgAuth({},!0)}},main={init:function(t){var e=this;e._initSelect2(),e._initSidebar(),e._initPageJs(t)},_initSidebar:function(){var t=$(".page-sidebar-wrapper");t.length>0&&t.m_sidebar()},_initPageJs:function(t){t&&t.init&&t.init()},_initSelect2:function(){$.fn.select2&&$.fn.select2.defaults.set("theme","bootstrap")}};